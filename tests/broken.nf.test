// This test is broken: it passes a dummy text file as a STEP file,
// which gmsh cannot parse. See GitHub issue #16.
// Re-enable once a real STEP fixture is generated.

nextflow_process {

    name "Test Process run_simulation"
    script "../main.nf"
    process "run_simulation"
    config "../nextflow.config"
    profile "docker"

    setup {
        file("tests/data/horn.step").withWriter('UTF-8') { writer ->
            writer.writeLine("dummy content")
        }
    }

    test("Should run the simulation") {
        when {
            process {
                """
                input[0] = tuple(file("tests/data/horn.step"), 0)
                """
            }
        }
        then {
            assert process.success
            assert snapshot(process.out).match()
        }
    }
}
