manifest {
    description = 'Horn simulation and analysis pipeline'
    mainScript = 'main.nf'
}

params {
    outdir = './results'
}

profiles {
    docker {
        docker.enabled = true
        process {
            // By default, give all processes 1 CPU.
            cpus = 1

            withName: generate_geometry {
                container = 'horn-geometry:latest'
            }
            withName: run_simulation {
                container = 'horn-solver:latest'
                cpus = 2
            }
            withName: merge_results {
                container = 'horn-analysis:latest'
            }
            withName: generate_plots {
                container = 'horn-analysis:latest'
            }
            withName: extract_kpis {
                container = 'horn-analysis:latest'
            }
            withName: generate_impedance_plot {
                container = 'horn-analysis:latest'
            }
            withName: generate_phase_plot {
                container = 'horn-analysis:latest'
            }
            withName: prescreen_drivers {
                container = 'horn-analysis:latest'
            }
            withName: generate_sweep_geometry {
                container = 'horn-geometry:latest'
            }
            withName: run_sweep_simulation {
                container = 'horn-solver:latest'
                cpus = 2
            }
            withName: merge_sweep_results {
                container = 'horn-analysis:latest'
            }
            withName: score_and_rank {
                container = 'horn-analysis:latest'
            }
            withName: generate_sweep_report {
                container = 'horn-analysis:latest'
            }
        }
    }
    standard {
        // Placeholder for local execution without Docker
    }
}
