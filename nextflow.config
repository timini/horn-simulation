manifest {
    description = 'Horn simulation and analysis pipeline'
    mainScript = 'main.nf'
}

params {
    outdir = './results'
}

profiles {
    docker {
        docker.enabled = true
        process {
            // By default, give all processes 1 CPU.
            cpus = 1

            withName: generate_geometry {
                container = 'horn-geometry:latest'
            }
            withName: run_simulation {
                container = 'horn-solver:latest'
                cpus = 2
            }
            withName: merge_results {
                container = 'horn-analysis:latest'
            }
            withName: generate_plots {
                container = 'horn-analysis:latest'
            }
            // Auto-select processes
            withName: generate_candidates {
                container = 'horn-core:latest'
            }
            withName: generate_candidate_geometry {
                container = 'horn-geometry:latest'
            }
            withName: run_candidate_simulation {
                container = 'horn-solver:latest'
                cpus = 2
            }
            withName: screen_drivers {
                container = 'horn-analysis:latest'
            }
            withName: rank_candidates {
                container = 'horn-analysis:latest'
            }
            withName: run_neumann_simulation {
                container = 'horn-solver:latest'
                cpus = 2
            }
            withName: generate_selection_report {
                container = 'horn-analysis:latest'
            }
        }
    }
    standard {
        // Placeholder for local execution without Docker
    }
}
